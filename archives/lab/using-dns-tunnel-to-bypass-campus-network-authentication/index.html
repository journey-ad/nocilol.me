<!DOCTYPE html>
<html lang="zh">
<!--
             -. .                                        
       _____   ',' ,                                    
     ,'     ,'   ', ',                                  
   ,'     ,'      |  |                                  
   \       \       |  |                                  
     \ /^\   \    ,' ,'                                  
           \   \ ,' ,'      L'Internationale,            
     / ~-.___\.-'  ,'            Sera le genre humain.   
   /   .______.- ~ \                                     
 /   /'          \   \                                   
 \./               \/'                                   
                                                         
-->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <title>ä½¿ç”¨DNSéš§é“ç»•è¿‡æ ¡å›­ç½‘è®¤è¯ - æ¶é­”èè‰æ§</title>
    
      
<link rel="stylesheet" href="/css/style.css">

      
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

      
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

      
<link rel="stylesheet" href="/libs/zpix/zpix.css">

      
<script src="/js/theme.js"></script>

    
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="æ¶é­”èè‰æ§" type="application/atom+xml">
</head>

<body id="bodyx" path="archives/lab/using-dns-tunnel-to-bypass-campus-network-authentication/">
    <div class="hd posts">
    <a class="back" href="javascript:void(0);" target="_self"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <h1 class="post-title">ä½¿ç”¨DNSéš§é“ç»•è¿‡æ ¡å›­ç½‘è®¤è¯</h1>
    <hr>

    
        <div class="outdated-notify">
            æœ¬æ–‡å‘å¸ƒäº <span class="num">-</span> å¤©å‰ï¼Œæ–‡ä¸­æ‰€æè¿°çš„ä¿¡æ¯å¯èƒ½å·²å‘ç”Ÿæ”¹å˜æˆ–æ˜¯è¿‡æ—¶ï¼Œè¯·æ³¨æ„è¾¨åˆ«
        </div>
    

    <div class="post-content">
        <p><img src="https://img.imjad.cn/images/2018/09/04/66192197_p0.jpg" alt="ã‚ãŸã„ãŒãƒ»ãƒ»ãƒ»æ¥ãŸããããï¼ @ ç„æœˆã¡ã²ã‚"></p>

    <div class="cplayer-template"
      id="cplayer-46124381"
      data-id="cplayer-46124381"
      data-playlist=%5B%7B%22name%22%3A%22loading...%22%2C%22artist%22%3A%22loading...%22%7D%5D
      data-ids=[751472]
      data-autoplay="false"
      style="position: relative"
    ></div>
    <script>
      (function(){

        let getLyric = id => {
          return new Promise((resolve, reject) => {
            fetch("https://api.imjad.cn/cloudmusic/?type=lyric&id=" + id).then(res => {
              return res.json()
            }).then(data => {
              // console.log(data)
              if(!data.lrc){
                data = Object.assign(data, {
                  lrc: {lyric: '[00:00.00]æ‰¾ä¸åˆ°æ­Œè¯çš„è¯´â€¦(âŠ™ï¹âŠ™)[99:00.00]'},
                  tlyric: {lyric: '[00:00.00]ç¿»è¯‘ä¸å­˜åœ¨çš„è¯´â€¦â•®(â•¯â–½â•°)â•­[99:00.00]'}
                })
              }
              let obj = {
                lyric: data.lrc.lyric,
                tlyric: data.tlyric.lyric
              }
              resolve(obj);
            })
          })
        }

        function loadcplayer() {
          if (typeof window.cplayerList === 'undefined') window.cplayerList = {};
          if (typeof window.cplayerList["cplayer-46124381"] !== 'undefined') return;
          if (!cplayer.prototype.add163) cplayer.prototype.add163 = async function add163(id) {
            if (!id) throw new Error("Unable Property.");
            let lyric = await getLyric(id);
            // console.log(lyric)

            return fetch("https://api.imjad.cn/cloudmusic/?type=detail&id=" + id).then(function(res){return res.json()}).then(function(data){
              let obj = {
                name: data.songs[0].name,
                artist: data.songs[0].ar.map(function(ar){ return ar.name }).join(','),
                poster: data.songs[0].al.picUrl,
                lyric: lyric.lyric,
                sublyric: lyric.tlyric,
                src: 'https://api.imjad.cn/cloudmusic/?type=song&raw=true&id=' + id
              }
              this.add(obj);
              return obj;
            }.bind(this))
          }

          window.cplayerList["cplayer-46124381"] = new cplayer({
            element: document.getElementById("cplayer-46124381"),
            playlist: [{"name":"loading...","artist":"loading..."}],
            generateBeforeElement: false,
            deleteElementAfterGenerate: false,
            autoplay: false,
            zoomOutKana: true,
            style: `c-player {
                      font-size: 16px !important;
                      position: relative;
                      left: 50%;
                      transform: translateX(-50%);
                      width: auto;
                      max-width: 550px;
                      margin: 30px auto;
                    }
                    c-player .cp-controls{
                      user-select: none;
                    }
                    c-player .cp-lyric{
                      width: 100%;
                      margin: 0.41667em 0;
                    }
                    c-player .cp-play-button .cp-play-icon.cp-play-icon-paused {
                      margin-left: 0.8em;
                    }
                    c-player .cp-drop-down-menu {
                      line-height: 1.85;
                    }
                    @media (max-width: 768px) {
                      c-player{
                        font-size: 12px !important;
                        left: auto;
                        transform: none;
                        width: 100%;
                        margin: 10px auto;
                      }
                      c-player .cp-mainbody{
                        min-height: 5.16667em;
                      }
                      c-player .cp-poster{
                        width: 5.16667em;
                        height: 5.16667em;
                      }
                      c-player .cp-center-container{
                        height: 5.16667em;
                      }
                      c-player .cp-play-button, c-player .cp-volume-button, c-player .cp-prev-button, c-player .cp-list-button, c-player .cp-mode-button, c-player .cp-next-button{
                        width: 1.54167em;
                        height: 1.54167em;
                      }
                      c-player .cp-icon, c-player .cp-prev-icon, c-player .cp-next-icon, c-player .cp-volume-icon, c-player .cp-random-icon, c-player .cp-single-icon, c-player .cp-loop-icon, c-player .cp-list-icon{
                        height: 1.54167em;
                        width: 1.54167em;
                      }
                      c-player .cp-play-button{
                        height: 2.8em;
                        width: 2.8em;
                      }
                      c-player .cp-play-button .cp-play-icon{
                        margin: 0.8em;
                      }
                      c-player .cp-play-button .cp-play-icon.cp-play-icon-paused {
                        margin: 0.7875em;
                        margin-left: 1em;
                      }
                      c-player .cp-volume-icon {
                        width: 1.76667em;
                      }
                      c-player .cp-list-button {
                        width: 1.54167em;
                        height: 1.54167em;
                      }
                      c-player .cp-mode-button {
                        width: 1.54167em;
                        height: 1.54167em;
                      }
                    }
                    `
          });

          window.cplayerList["cplayer-46124381"].add163(751472)

          let player = window.cplayerList["cplayer-46124381"]
          player.to(1)
          player.remove(player.playlist[0])
        }
        
        if (typeof window.cplayer === 'undefined' && !document.getElementById("cplayer-script")) {
          var js = document.createElement("script");
          js.src = 'https://cdn.jsdelivr.net/gh/MoePlayer/cPlayer/dist/cplayer.js';
          js.id = "cplayer-script";
          js.addEventListener("load", loadcplayer);
          document.body.appendChild(js);
        } else {
          window.addEventListener("load", loadcplayer);
        }
      })()
    </script>

<h2>ä¸€ç‚¹<del>å¤§èƒ†çš„</del>æƒ³æ³•</h2><p><a href="https://imjad.cn/archives/lab/giwifi-auth-process-analysis-and-simulation-login" target="_blank" rel="noopener">å‰å‡ æ—¥åˆ†æå®Œæ ¡å›­ç½‘çš„ç™»å½•è®¤è¯è¿‡ç¨‹</a>ä¹‹åå·²ç»è¿‡äº†å‡ å¤©ï¼Œè¿‘æ—¥çªå‘å¥‡æƒ³ï¼Œæƒ³è¯•ç€èƒ½ä¸èƒ½ç»•è¿‡æ ¡å›­ç½‘çš„è¿™ä¸ªç½‘é¡µè®¤è¯ï¼Œå®ç°è¯¸å¦‚å…è´¹ä¸Šç½‘ã€åœ¨ä¸Šç½‘åŒºé—´å¤–ä¸Šç½‘ç­‰çš„æ“ä½œ</p>
<p>ç”±äºæœ¬äººå¯¹webå®‰å…¨æ–¹é¢æ‰€çŸ¥ç”šå°‘ï¼Œé‚åˆæ˜¯ä¸€ç•ªæœå¯»ï¼Œå‘ç°åœ¨æ­¤ä¹‹å‰å·²ç»æœ‰è®¸å¤šå…ˆè¾ˆå®Œæˆäº†è¿™æ–¹é¢çš„ç›®æ ‡ã€‚è‡ªå·±ä¹Ÿè¯•ç€æŠ˜è…¾äº†ä¸€é€š</p>
<p>äºæ˜¯ä¾¿æ‹¾äººç‰™æ…§ï¼Œå‡‘æˆè¿™ç¯‡æ–‡ç« </p>
<h2>æŠ€æœ¯åŸç†</h2><p>ç»è¿‡ä¸€ç•ªæœå¯»ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€äº›æ–¹æ³•ã€‚è€Œè¿™äº›æ–¹æ³•ï¼Œè™½è¯´ç”¨çš„è½¯ä»¶å·¥å…·å„ä¸ç›¸åŒï¼Œä½†æ€»ä½“çœ‹ä¸‹æ¥ï¼Œåˆ©ç”¨çš„éƒ½æ˜¯ä¸€ä¸ªåŸç†ï¼š</p>
<p>ä¸ºäº†å®ç°ç½‘é¡µè®¤è¯ï¼Œç½‘å…³è®¾å¤‡å¿…é¡»è¦ç»™ç»ˆç«¯åˆ†é…IPï¼ŒåŒæ—¶åŠ«æŒ80ã€443ç«¯å£çš„æ•°æ®åŒ…å¹¶è·³è½¬è‡³è®¤è¯é¡µ(è¿™ä¹Ÿæ˜¯httpé¡µæ‰èƒ½è·³è½¬è‡³è®¤è¯é¡µçš„åŸå› ï¼Œhttpså°†ä¼šæ— æ³•è·³è½¬æˆ–æŠ¥è¯ä¹¦é”™è¯¯)ã€‚åœ¨è®¤è¯é€šè¿‡åæ”¾è¡Œè¿™ä¸¤ä¸ªç«¯å£ï¼Œå…¶ä»–çš„ç«¯å£ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹æœ‰ä¸€äº›ç«¯å£å´å¹¶éå¦‚æ­¤ï¼Œæ¯”å¦‚æœ¬æ–‡çš„ä¸»è§’â€”â€”UDP 53ç«¯å£</p>
<blockquote>
<p>ç±»ä¼¼è¿™æ ·çš„ç«¯å£è¿˜æœ‰ä¸€äº›ï¼Œæ¯”å¦‚UDP 67ï¼Œç”¨äºDHCP</p>
</blockquote>
<p>å­¦è¿‡è®¡ç®—æœºç½‘ç»œåŸºç¡€çŸ¥è¯†çš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œåœ¨UDP 53ä¸Šè¿è¡Œçš„æ˜¯DNSåè®®ï¼ŒåŸŸåè§£æçš„æ•°æ®åŒ…å°±é€šè¿‡è¿™ä¸ªç«¯å£è¿›è¡Œä¼ è¾“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç½‘å…³éƒ½ä¼šæ”¾è¡Œè¿™ä¸ªç«¯å£çš„UDPé€šä¿¡ï¼Œç”šè‡³æ˜¯æ•´ä¸ªç«¯å£(æ³¨æ„æ˜¯ä¸€èˆ¬æƒ…å†µï¼Œè¿™ç‚¹ä¹‹åä¼šè¯¦ç»†è¯´æ˜)ã€‚å¯¹äºæ­¤ç±»ç½‘å…³ï¼Œè¦ç»•è¿‡è®¤è¯å°±å¾ˆç®€å•äº†ï¼Œåªéœ€ä¸€å°ä½¿ç”¨53ç«¯å£é€šä¿¡çš„ä»£ç†æœåŠ¡å™¨å³å¯ã€‚è¿™ç§æƒ…å†µè¿‡äºç®€å•ï¼Œæ²¡æœ‰å•ç‹¬å†™ä¸€ç¯‡æ–‡ç« çš„å¿…è¦ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥è°ˆä¸€è°ˆé‚£äº›ã€Œéä¸€èˆ¬ã€çš„æƒ…å†µ(æˆ‘æ ¡æ­£æ˜¯è¿™ç§æƒ…å†µğŸŒ)</p>
<p>éƒ¨åˆ†ç½‘å…³è™½ç„¶æ”¾è¡Œäº†53ç«¯å£ï¼Œå´åœ¨ç½‘å…³å¤„åŠ«æŒäº†53ç«¯å£çš„é€šä¿¡ï¼Œè¿™ä½¿å¾—ç»ˆç«¯çš„æ•°æ®æ ¹æœ¬åˆ°è¾¾ä¸äº†è¿œç«¯ï¼ŒDNSè§£æè¯·æ±‚ä¼šè¢«ç½‘å…³æŠ¢ç­”ï¼Œè€Œå…¶ä»–æ•°æ®åˆ™æ˜¯ç›´æ¥ä¸¢å¼ƒã€‚è¡¨ç°å°±æ˜¯ä½¿ç”¨<code>nslookup</code>ç­‰å‘½ä»¤èƒ½æŸ¥è¯¢åˆ°æ­£ç¡®çš„è§£æç»“æœï¼Œä½¿ç”¨<code>tcping</code>ç­‰TCPæ•°æ®åŒ…æµ‹è¯•å·¥å…·ä¹Ÿèƒ½çœ‹åˆ°ç«¯å£å¼€æ”¾ï¼Œå»¶è¿Ÿå´æ˜¯ç¥å¥‡çš„1ms(å³æœ¬æœºåˆ°ç½‘å…³çš„å»¶è¿Ÿ)</p>
<p>é‚£ä¹ˆå°±æ²¡æœ‰åŠæ³•äº†å—ï¼Ÿéä¹Ÿï¼Œè¦çŸ¥é“åŠ³åŠ¨äººæ°‘çš„æ™ºæ…§æ˜¯æ— ç©·çš„ï¼Œä¸ºäº†èƒ½å¤Ÿå…è´¹ä¸Šç½‘ï¼Œè¿™äº›æå®¢ä»¬å‘æ˜äº†è®¸å¤šç¥å¥‡çš„ï¼Œå ªç§°é»‘ç§‘æŠ€çš„ï¼Œç”šè‡³ç»†ç»†å“å‘³ä¸€ç•ªä¼šå‘ç°æœ‰äº›æç¬‘çš„æ–¹æ³•ã€‚</p>
<p><em>è¿™æ®µæ˜¯åœ¨è°ƒä¾ƒï¼Œã€Œå…è´¹ä¸Šç½‘ã€åªæ˜¯è¡¨é¢ï¼ŒèƒŒåçš„æ€æƒ³åŠæŠ€æœ¯éªŒè¯æ‰æ˜¯æœ€å¯è´µçš„</em></p>
<p>æ¯”å¦‚ç»™æˆ‘ä¸ªäººå°è±¡é¢‡æ·±çš„åˆ©ç”¨ICMPæŠ¥æ–‡(å³<code>ping</code>å‘½ä»¤çš„æ•°æ®åŒ…)å’Œæœ¬æ–‡ä»‹ç»çš„åˆ©ç”¨DNSæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡æ¥è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œè¿™ä¸¤ç§é€šä¿¡æ–¹å¼è¢«å½¢è±¡çš„ç§°ä¸ºã€ŒPINGéš§é“ã€å’Œã€ŒDNSéš§é“ã€</p>
<p>ä½†éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹æ³•è™½ç„¶å®è·µè¯æ˜å¯è¡Œï¼Œä½†ç”±äºå¯¹åº”çš„åè®®è®¾è®¡ä¸æ˜¯ç”¨æ¥ä¼ è¾“æ•°æ®çš„ï¼Œå¼ºè¡Œä½¿å…¶æ”¯æŒæ•°æ®ä¼ è¾“åï¼Œé€Ÿåº¦ä¹Ÿæ˜¯æ…¢çš„ç¦»è°±ï¼Œå¹¶ä¸”å¤§é‡é¢‘ç¹çš„Pingè¯·æ±‚æˆ–DNSæŸ¥è¯¢ä¹Ÿå¾ˆå®¹æ˜“è¢«ç”„åˆ«ä¸ºå¼‚å¸¸æµé‡ä»è€Œé­åˆ°å°é”ã€‚å› æ­¤æœ¬æ–‡çš„æ„ä¹‰æ›´åœ¨äºã€ŒæŠ˜è…¾ã€çš„è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯ç»“æœã€‚<del>ä¹°ä¸€å¼ æ— é™æµé‡å¡å¼€çƒ­ç‚¹ï¼Œç›¸æ¯”è¿™äº›ä½“éªŒè¦å¼ºå¤šäº†ï¼Œæ¯•ç«Ÿèƒ½ç”¨é’±è§£å†³çš„äº‹éƒ½ä¸ç®—äº‹å˜›</del></p>
<h2>DNSéš§é“</h2><p>å®ç°DNSéš§é“æœ‰è®¸å¤šç§æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨å·¥å…·<strong>dns2tcp</strong>æ¥å®ç°</p>
<p>è¿™ç§æ–¹æ³•éœ€è¦ä¸€å°Linuxç³»ç»Ÿçš„å¤–éƒ¨VPSæ¥ä½œä¸ºä»£ç†æœåŠ¡å™¨ã€ä¸€ä¸ªå¯é…ç½®NSè§£æçš„åŸŸåä½œä¸ºä¼ è¾“ä¸­ä»‹</p>
<p><strong>å¦è¯·æ³¨æ„ï¼Œæœ¬æ–‡å‡ºç°çš„é…ç½®æ–‡ä»¶åŠå‘½ä»¤çš„å‚æ•°å€¼ä¸å¯ç›´æ¥å¥—ç”¨ï¼Œéœ€æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹</strong></p>
<h3>åœ¨åŸŸåè§£æé¢æ¿çš„æ“ä½œ</h3><p>å›½å†…æ”¯æŒNSè®°å½•è§£æçš„DNSè§£ææœåŠ¡æ®æˆ‘æ‰€çŸ¥æœ‰DNSPodå’ŒCloudXNSï¼Œè¿™é‡Œä½¿ç”¨CloudXNS</p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œéœ€è¦æ·»åŠ ä¸¤æ¡è®°å½•ï¼š</p>
<p>ä¸€æ¡Aè®°å½•ï¼Œä¸»æœºåä»»æ„ï¼Œè¿™é‡Œä½¿ç”¨<code>temp1</code>ï¼Œå€¼ä¸ºVPSçš„IP</p>
<p>ä¸€æ¡NSè®°å½•ï¼Œä¸»æœºåä»»æ„ä½†éœ€ç‰¢è®°ï¼Œè¿™é‡Œä½¿ç”¨<code>dns2tcp</code>ï¼Œå€¼ä¸ºAè®°å½•çš„ä¸»æœºåå¯¹åº”çš„å®Œæ•´åŸŸåï¼Œè¿™é‡Œæ˜¯<code>temp1.nocilol.me</code></p>
<p><img src="https://img.imjad.cn/images/2018/09/04/sp180903_230655.png" alt="åŸŸåè§£æ"></p>
<h3>åœ¨æœåŠ¡ç«¯çš„æ“ä½œ</h3><h4>é˜²ç«å¢™é…ç½®</h4><p>é¦–å…ˆéœ€è¦åœ¨å®‰å…¨ç»„å’Œé˜²ç«å¢™è§„åˆ™ä¸­æ”¾è¡Œ53ç«¯å£çš„UDPè¿æ¥ï¼Œå®‰å…¨ç»„å‚è€ƒå„IDCçš„é…ç½®æ•™ç¨‹ï¼Œé˜²ç«å¢™è‹¥ä½¿ç”¨iptablesçš„è¯ï¼Œæ·»åŠ å¦‚ä¸‹è§„åˆ™ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell">-A INPUT -p udp -m udp --dport 53 -j ACCEPT
-A OUTPUT -p udp -m udp --sport 53 -j ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4>å®‰è£…dns2tcp</h4><p>ä¸€èˆ¬Linuxå‘è¡Œç‰ˆçš„è½¯ä»¶ä»“åº“é‡Œéƒ½å¸¦äº†dns2tcpï¼Œç›´æ¥å®‰è£…å³å¯ï¼Œè‹¥æ— çš„è¯å¯ä»¥è‡ªè¡Œç¼–è¯‘ï¼Œé¡¹ç›®åœ°å€ä¸º<a href="https://github.com/alex-sector/dns2tcp" target="_blank" rel="noopener">alex-sector/dns2tcp</a></p>
<p><em>Windowsç³»ç»Ÿä¸æ”¯æŒdns2tcpçš„æœåŠ¡ç«¯dns2tcpdï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„</em></p>
<p>åœ¨Debianç³»çš„å‘è¡Œç‰ˆä¸­ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤å®‰è£…ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell"># apt install dns2tcp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å·¥å…·ä¸å¤§ï¼Œå¾ˆå¿«å°±ä¼šå®‰è£…å®Œæ¯•</p>
<h4>é…ç½®dns2tcpd</h4><p>é…ç½®æ–‡ä»¶é»˜è®¤ç›®å½•ä¸º<code>~/.dns2tcpdrc</code>ï¼Œä¹Ÿå¯åœ¨éšåå¯åŠ¨<code>dns2tcpd</code>æ—¶ä»¥<code>-f</code>å‚æ•°æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„</p>
<p>é…ç½®æ–‡ä»¶å†…å®¹ä¸ºï¼š</p>
<pre><code>listen = 0.0.0.0
port = 53
user = nobody
key = your_own_password
chroot = /tmp
domain = dns2tcp.nocilol.me
resources = ssh:127.0.0.1:22 , smtp:127.0.0.1:25</code></pre><p>å…¶ä¸­çš„<code>key</code>å­—æ®µå€¼ä¸ºå£ä»¤ï¼Œå¯ä»¥é˜²æ­¢ä¸çŸ¥é“å£ä»¤çš„äººè¿æ¥åˆ°æœ¬æœºçš„dns2tcpæœåŠ¡</p>
<h4>è¿è¡Œdns2tcpd</h4><p>è°ƒç”¨è¯´æ˜</p>
<pre><code>Usage : dns2tcpd [ -i IP ] [ -F ] [ -d debug_level ] [ -f config-file ] [ -p pidfile ]
         -F : dns2tcpd will run in foreground</code></pre><p>æ‰§è¡Œä¸‹åˆ—å‘½ä»¤æµ‹è¯•å¯åŠ¨æœåŠ¡ç«¯è¿›ç¨‹ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell"># dns2tcpd -F -d 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¦‚æœé…ç½®æ–‡ä»¶æ— è¯¯ï¼Œåº”å½“ä¼šè¾“å‡ºç±»ä¼¼å¦‚ä¸‹çš„å†…å®¹ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell">15:45:14 : Debug options.c:97   Add resource ssh:127.0.0.1 port 22
15:45:14 : Debug options.c:97   Add resource smtp:127.0.0.1 port 25
15:45:14 : Debug socket.c:55    Listening on 0.0.0.0:53 for domain dns2tcp.nocilol.me
Starting Server v0.5.2...
15:45:14 : Debug main.c:132     Chroot to /tmp
15:45:14 : Debug main.c:142     Change to user nobody<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å®é™…ä½¿ç”¨æ—¶æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼åœ¨åå°è¿è¡Œï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell"># dns2tcpd -d 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3>åœ¨å®¢æˆ·ç«¯çš„æ“ä½œ</h3><p>ä»è¿™ä¸€æ­¥å¼€å§‹å°±å¯ä»¥æ–­ç½‘æ“ä½œäº†ï¼Œæ–­ç½‘æŒ‡çš„æ˜¯è¿æ¥çƒ­ç‚¹æˆ–æ’ä¸Šç½‘çº¿ï¼Œä½†ä¸è¿›è¡Œè®¤è¯çš„çŠ¶æ€</p>
<p>dns2tcpçš„å®‰è£…è¿‡ç¨‹ä¸å†èµ˜è¿°ï¼ŒWindowsç³»ç»Ÿç”¨æˆ·å¯ä»¥è‡ªè¡Œä»æºä»£ç ç¼–è¯‘æˆ–åœ¨<a href="http://azertyfab.free.fr/dns2tcp/" target="_blank" rel="noopener">è¿™ä¸ªé¡µé¢</a>ç›´æ¥ä¸‹è½½åˆ°ç¼–è¯‘å¥½çš„dns2tcpc.exe</p>
<h4>é…ç½®dns2tcpc</h4><p>é…ç½®æ–‡ä»¶é»˜è®¤ç›®å½•ä¸º<code>~/.dns2tcpdrc</code>ï¼Œä¹Ÿå¯åœ¨éšåå¯åŠ¨<code>dns2tcp</code>æ—¶ä»¥<code>-f</code>å‚æ•°æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„</p>
<p>é…ç½®æ–‡ä»¶å†…å®¹ä¸ºï¼š</p>
<pre><code>domain = dns2tcp.nocilol.me
resource = ssh
local_port = 2222
debug_level = 2
key = your_own_password
# server = your_vps_ip</code></pre><h4>è¿è¡Œdns2tcpc</h4><p>è°ƒç”¨è¯´æ˜</p>
<pre><code>dns2tcp v0.5.2 ( http://www.hsc.fr/ )
Usage : dns2tcpc [options] [server] 
    -c             : enable compression
    -z &lt;domain&gt;    : domain to use (mandatory)
    -d &lt;1|2|3&gt;    : debug_level (1, 2 or 3)
    -r &lt;resource&gt;    : resource to access
    -k &lt;key&gt;    : pre-shared key
    -f &lt;filename&gt;    : configuration file
    -l &lt;port|-&gt;    : local port to bind, &#39;-&#39; is for stdin (mandatory if resource defined without program )
    -e &lt;program&gt;    : program to execute
    -t &lt;delay&gt;    : max DNS server&#39;s answer delay in seconds (default is 3)
    -T &lt;TXT|KEY&gt;    : DNS request type (default is TXT)
    server    : DNS server to use
    If no resources are specified, available resources will be printed</code></pre><p>æ‰§è¡Œä¸‹åˆ—å‘½ä»¤æµ‹è¯•ä¸æœåŠ¡ç«¯çš„è¿æ¥æ˜¯å¦é€šç•…ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ dns2tcpc -z dns2tcp.nocilol.me -d 3 -k your_own_password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°†è¾“å‡ºç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼š</p>
<pre><code>Available connection(s) : 
    ssh
    smtp

Note : Compression SEEMS available !
No DNS given, using 223.5.5.5 (first system preferred DNS server)
debug level 3
Debug socket.c:233    Create socket for dns : &#39;223.5.5.5&#39; 
Debug session.c:46    Request challenge
Debug requests.c:146    Sending dns id = 0x3f0b
Debug requests.c:97    Query is AAAAABV/AA.=auth.dns2tcp.nocilol.me len 35
Debug rr.c:106    rr_decode_next_reply_encode base64 data was = AQUAABV/AFkxN0pEMEpZT0dUR1lJUUI (reply len = 34)
Debug session.c:53    Challenge = &#39;Y17JD0JYOGTGYIQB&#39;
Debug session.c:54    Session created (0x501)
Debug session.c:77    Sending response : &#39;11F5Ab37A7DE310AC28F396B75E45B186D24AB39&#39; (key = your_own_password) 
Debug requests.c:146    Sending dns id = 0xd21f
Debug requests.c:97    Query is AQWBgAABADExRjVBQzE3QTdERTMzMEFDMjlGNzM2Qjc1RTQzNzE1NkIyNEFCNjk.=auth.dns2tcp.nocilol.me len 88
Debug rr.c:106    rr_decode_next_reply_encode base64 data was = AQWBgAABAA (reply len = 13)
Debug auth.c:58    Requesting resource
Debug requests.c:146    Sending dns id = 0x2e29
Debug requests.c:97    Query is AQWPJOMjAA.=resource.dns2tcp.nocilol.me len 39
Debug rr.c:106    rr_decode_next_reply_encode base64 data was = 1FwCb/x/AHNzaA (reply len = 17)
Debug rr.c:106    rr_decode_next_reply_encode base64 data was = 1FwCb/x/AHNtdHA (reply len = 18)</code></pre><p>å¦‚æœè¾“å‡ºç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼Œè¯·æ£€æŸ¥æ“ä½œæ˜¯å¦æœ‰è¯¯ï¼Œè‹¥æ“ä½œæ— è¯¯ï¼Œè¯·ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ŒDNSè§£æç¼“å­˜éœ€è¦ä¸€å®šæ—¶é—´æ¥åˆ·æ–°å’Œä¼ é€’ï¼š</p>
<pre><code>No DNS given, using 223.5.5.5 (first system preferred DNS server)
debug level 3
Debug socket.c:233    Create socket for dns : &#39;223.5.5.5&#39; 
Debug session.c:46    Request challenge
Debug requests.c:146    Sending dns id = 0xbc7b
Debug requests.c:97    Query is AAAAAOt7AA.=auth.dns2tcp.nocilol.me len 35
No response from DNS 223.5.5.5</code></pre><p>æµ‹è¯•æˆåŠŸä¹‹åï¼Œæ‰§è¡Œä¸‹åˆ—å‘½ä»¤å¯åŠ¨å®¢æˆ·ç«¯è¿›ç¨‹ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ dns2tcpc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>å°†ä¼šè¾“å‡ºç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼š</p>
<pre><code>debug level 2
Debug socket.c:233    Create socket for dns : &#39;223.5.5.5&#39; 
Listening on port : 2222
When connected press enter at any time to dump the queue</code></pre><p>ä¿æŒè¿™ä¸ªç»ˆç«¯çª—å£æ‰“å¼€ï¼Œä¸è¦å…³é—­</p>
<h4>è½¬æ¢ä¸ºSOCKS v5é€šç”¨ä»£ç†</h4><h5>Linux</h5><p>æ–°æ‰“å¼€ä¸€ä¸ªç»ˆç«¯çª—å£å¹¶æ‰§è¡Œä¸‹åˆ—å‘½ä»¤<del>æ˜¯ä¸æ˜¯æœ‰ç‚¹ä¼¼æ›¾ç›¸è¯†</del>ï¼š</p>
<pre class="line-numbers language-shell"><code class="language-shell">$ ssh user@127.0.0.1 -p 2222 -D 2333<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h5>Windows</h5><p>ä½¿ç”¨SSHè¿æ¥å·¥å…·çš„éš§é“åŠŸèƒ½ï¼Œè¿™é‡Œç»™ä¸€ä¸ªXshellçš„é…ç½®ç¤ºä¾‹ï¼š</p>
<p><img src="https://img.imjad.cn/images/2018/09/04/sp180904_095832.png" alt="è¿æ¥è‡³dns2tcpcè½¬å‘çš„sshç«¯å£"></p>
<p><img src="https://img.imjad.cn/images/2018/09/04/sp180904_095617.png" alt="SSHéš§é“é…ç½®"></p>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼ŒSSHéš§é“å°†è¿æ¥æˆåŠŸï¼ŒåŒæ—¶å¯ä»¥è§‚å¯Ÿåˆ°dns2tcpcçš„ç»ˆç«¯æ‰“å°å‡ºå¤§é‡æ—¥å¿—ä¿¡æ¯</p>
<h4>é…ç½®ç³»ç»Ÿä»£ç†æˆ–è½¯ä»¶ä»£ç†</h4><p>åœ¨ç³»ç»Ÿæˆ–è½¯ä»¶çš„ä»£ç†è®¾ç½®ä¸­é…ç½®ä¸ºSOCKS v5ï¼Œåœ°å€<code>127.0.0.1</code>ï¼Œç«¯å£<code>2333</code></p>
<p>å…·ä½“é…ç½®æ–¹æ³•ä¸å†è¯¦è¿°ï¼Œå®Œæˆåå³å¯æ­£å¸¸ä¸Šç½‘</p>
<h2>ä½“éªŒå¦‚ä½•</h2><p>é¦–å…ˆæ³¼ä¸€ç›†å‡‰æ°´ï¼Œä½“éªŒå¯ä»¥ç”¨ã€Œç³Ÿç³•ã€æ¥å½¢å®¹:(</p>
<p>æœ¬æ–‡å¼€å¤´æ›¾æåˆ°ï¼šã€Œâ€¦è™½ç„¶å®è·µè¯æ˜å¯è¡Œï¼Œä½†ç”±äºå¯¹åº”çš„åè®®è®¾è®¡ä¸æ˜¯ç”¨æ¥ä¼ è¾“æ•°æ®çš„ï¼Œå¼ºè¡Œä½¿å…¶æ”¯æŒæ•°æ®ä¼ è¾“åï¼Œé€Ÿåº¦ä¹Ÿæ˜¯æ…¢çš„ç¦»è°±ï¼Œå¹¶ä¸”å¤§é‡é¢‘ç¹çš„Pingè¯·æ±‚æˆ–DNSæŸ¥è¯¢ä¹Ÿå¾ˆå®¹æ˜“è¢«ç”„åˆ«ä¸ºå¼‚å¸¸æµé‡ä»è€Œé­åˆ°å°é”ã€‚ã€</p>
<p>è€Œå…·ä½“ä½“éªŒå¦‚ä½•ï¼Œæˆ‘å°±è´´ä¸¤å¼ å›¾å§ï¼Œä¸€åˆ‡å°½åœ¨ä¸è¨€ä¸­ğŸŒ</p>
<p><img src="https://img.imjad.cn/images/2018/09/04/TIM20180904101615.png" alt="æµè§ˆå™¨çš„ä¸‹è½½é€Ÿåº¦"></p>
<p><img src="https://img.imjad.cn/images/2018/09/04/TIM20180904101626.png" alt="ç™¾åº¦é¦–é¡µé¦–æ¬¡åŠ è½½æ—¶é—´"></p>
<p>è™½ç„¶ä½“éªŒä¸å°½å¦‚äººæ„ï¼Œä½†æ˜¯ç”Ÿå‘½åœ¨äºæŠ˜è…¾å˜›ã€‚åœ¨æŠ˜è…¾çš„è¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿäº†è§£åˆ°åœ¨å°å°çš„Webè®¤è¯çš„èƒŒåè¿˜æœ‰å¦‚æ­¤å¤šçš„ã€æœ‰è¶£çš„çŸ¥è¯†ï¼Œæ¯”èµ·æœ€åˆçš„ç›®çš„è€Œè¨€ï¼Œè¦é‡è¦çš„å¤šäº†ã€‚</p>
<p>äººç”Ÿä¹Ÿåº”å¤§æŠµå¦‚æ­¤å§</p>
<h2>å‚è€ƒ</h2><p><a href="https://qiuri.org/posts/2152501839/" target="_blank" rel="noopener">é€è¿‡DNS Tunnelç»•è¿‡æ ¡å›­ç½‘è®¤è¯ç³»ç»Ÿå®ç°å…è´¹ä¸Šç½‘</a></p>
<p><a href="https://www.cnblogs.com/nkqlhqc/p/7805837.html" target="_blank" rel="noopener">ç»•è¿‡æ ¡å›­ç½‘WEBè®¤è¯_dns2tcpå®ç°</a></p>

    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    

    <script>
        var pub_date = 1535999820000;
    </script>
</div>
    <div class="footer"
     id="footer">
    <p>
        Copyright Â© 2020 <a class="flink"
           href="https://nocilol.me">æ¶é­”èè‰æ§</a> Â· Theme by <a class="flink"
           href="https://github.com/journey-ad/hexo-theme-geek">Geek</a>.
        <br>
        Made with <i class="fa fa-heart throb"
           style="color:#d43f57"></i> by <span class="author"
              itemprop="copyrightHolder">journey.ad</span>.
        <label class="el-switch el-switch-green el-switch-sm"
               style="vertical-align: sub;">
            <input type="checkbox"
                   name="switch"
                   id="update_style">
            <span class="el-switch-style"></span>
        </label>
    </p>
</div>

<a href="javascript:void(0);" class="back-to-top" target="_self"></a>

<input type="hidden"
       id="web_style"
       value="white">
<input type="hidden"
       id="valine_appid"
       value="CaQKuPQDfnfPFUkTw6MMt8ME-gzGzoHsz">
<input type="hidden"
       id="valine_appKey"
       value="uWuwGS1xiIwh3zHKENc7ubyL">
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>

  
<script src="/libs/jquery.min.js"></script>

  
<script src="/libs/highlight/highlight.pack.js"></script>

  
<script src="/js/js.js"></script>


<style type="text/css">
    .v * {
        /* color: #698fca; */
    }

    .v .vlist .vcard .vhead .vsys {
        color: #3a3e4a;
    }

    .v .vlist .vcard .vh .vmeta .vat {
        color: #638fd5;
    }

    .v .vlist .vcard .vhead .vnick {
        color: #6ba1ff;
    }

    .v a {
        color: #8696b1;
    }

    .v .vlist .vcard .vhead .vnick:hover {
        color: #669bfc;
    }

    .v .vcards .vcard .vhead .vnick {
        padding-left: 1px;
    }

    .v .vcontent .vemoji {
        max-width: 30px;
    }

    .v[data-class=v] p {
        color: inherit;
    }

</style>

<!-- Load TweenLite -->
<script src="https://cdn.jsdelivr.net/npm/greensock@1.20.2/dist/TweenLite.js"></script>

<!-- Copyrighted cubism SDK -->
<script src="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"></script>
<!-- Load Pixi (dependency for cubism 2/4 integrated loader) -->
<script src="https://cdn.jsdelivr.net/npm/pixi.js@5.3.6/dist/pixi.min.js"></script>
<!-- Load cubism 4 integrated loader -->
<script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display@0.3.1/dist/cubism4.min.js"></script>

<!-- Load pio and alternative loader -->
<link href="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/pio.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/pio.js"></script>
<script src="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/pio_sdk4.js"></script>
<script src="https://cdn.jsdelivr.net/gh/journey-ad/blog-img@76ba2b3/live2d/lib/load.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-71903189-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-71903189-1');
</script>

</body>

</html>